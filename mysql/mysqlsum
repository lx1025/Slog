select ktv_id, sum(total_fee)/100 as sum_total_fee from archive_order \
where state=2 and channel in (0, 1) and tp not in (1, 2, 7) and  \
finish_time >= '2016-02-16 00:00:00' and finish_time <= '2016-02-16 23:59:59'
group by ktv_id order by sum_total_fee desc limit 10;

select ktv_id, MIN(finish_time) as first_order_time from archive_order group by ktv_id order by first_order_time desc limit 10;
